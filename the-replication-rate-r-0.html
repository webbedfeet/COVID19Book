<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 The Replication rate, \(R_0\) | Examine the COVID-19 pandemic with data</title>
  <meta name="description" content="6 The Replication rate, \(R_0\) | Examine the COVID-19 pandemic with data" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6 The Replication rate, \(R_0\) | Examine the COVID-19 pandemic with data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://seandavi.github.io/COVID19Book" />
  <meta property="og:image" content="https://seandavi.github.io/COVID19Bookimages/logo.png" />
  
  <meta name="github-repo" content="seandavi/COVID19Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 The Replication rate, \(R_0\) | Examine the COVID-19 pandemic with data" />
  
  
  <meta name="twitter:image" content="https://seandavi.github.io/COVID19Bookimages/logo.png" />

<meta name="author" content="Vincent J. Carey" />
<meta name="author" content="Charles Morefield" />
<meta name="author" content="John Mallery" />
<meta name="author" content="Sean Davis" />


<meta name="date" content="2020-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="use-cases.html"/>
<link rel="next" href="european-datasets.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Motivation</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#origins-of-this-package"><i class="fa fa-check"></i><b>1.1</b> Origins of this package</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> Quick start</a><ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#covid-19-resources-in-this-package"><i class="fa fa-check"></i><b>2.2</b> COVID-19 resources in this package</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="todo-give-background-on-datasets.html"><a href="todo-give-background-on-datasets.html"><i class="fa fa-check"></i><b>3</b> TODO: give background on datasets</a></li>
<li class="chapter" data-level="4" data-path="epidemic-time-series-data.html"><a href="epidemic-time-series-data.html"><i class="fa fa-check"></i><b>4</b> Epidemic time series data</a><ul>
<li class="chapter" data-level="4.1" data-path="epidemic-time-series-data.html"><a href="epidemic-time-series-data.html#access-data"><i class="fa fa-check"></i><b>4.1</b> Access data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="epidemic-time-series-data.html"><a href="epidemic-time-series-data.html#jhu-dataset"><i class="fa fa-check"></i><b>4.1.1</b> JHU Dataset</a></li>
<li class="chapter" data-level="4.1.2" data-path="epidemic-time-series-data.html"><a href="epidemic-time-series-data.html#usafacts-dataset"><i class="fa fa-check"></i><b>4.1.2</b> USAFacts Dataset</a></li>
<li class="chapter" data-level="4.1.3" data-path="epidemic-time-series-data.html"><a href="epidemic-time-series-data.html#nytimes-datasets"><i class="fa fa-check"></i><b>4.1.3</b> NYTimes datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="use-cases.html"><a href="use-cases.html"><i class="fa fa-check"></i><b>5</b> Use cases</a><ul>
<li class="chapter" data-level="5.1" data-path="use-cases.html"><a href="use-cases.html#basic-data-exploration"><i class="fa fa-check"></i><b>5.1</b> Basic data exploration</a></li>
<li class="chapter" data-level="5.2" data-path="use-cases.html"><a href="use-cases.html#visualize-time-series-data"><i class="fa fa-check"></i><b>5.2</b> Visualize time series data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html"><i class="fa fa-check"></i><b>6</b> The Replication rate, <span class="math inline">\(R_0\)</span></a><ul>
<li class="chapter" data-level="6.1" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#learning-goals-and-objectives"><i class="fa fa-check"></i><b>6.1</b> Learning goals and objectives</a></li>
<li class="chapter" data-level="6.2" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#background"><i class="fa fa-check"></i><b>6.2</b> Background</a><ul>
<li class="chapter" data-level="6.2.1" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#what-is-r_0"><i class="fa fa-check"></i><b>6.2.1</b> What is <span class="math inline">\(R_0\)</span>?</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#what-do-r_0-values-mean"><i class="fa fa-check"></i><b>6.2.2</b> What do <span class="math inline">\(R_0\)</span> values mean?</a></li>
<li class="chapter" data-level="6.2.3" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#what-variables-contribute-to-r_0"><i class="fa fa-check"></i><b>6.2.3</b> What variables contribute to <span class="math inline">\(R_0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#simulated-epidemic-model"><i class="fa fa-check"></i><b>6.3</b> Simulated epidemic model</a></li>
<li class="chapter" data-level="6.4" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#real-data-examples"><i class="fa fa-check"></i><b>6.4</b> Real data examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#hubei-province"><i class="fa fa-check"></i><b>6.4.1</b> Hubei Province</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#italy"><i class="fa fa-check"></i><b>6.4.2</b> Italy</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-replication-rate-r-0.html"><a href="the-replication-rate-r-0.html#new-york-city"><i class="fa fa-check"></i><b>6.4.3</b> New York City</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="european-datasets.html"><a href="european-datasets.html"><i class="fa fa-check"></i><b>7</b> European datasets</a></li>
<li class="chapter" data-level="8" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html"><i class="fa fa-check"></i><b>8</b> Epicurve Datasets</a><ul>
<li class="chapter" data-level="8.1" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#worldwide-datasets"><i class="fa fa-check"></i><b>8.1</b> Worldwide datasets</a></li>
<li class="chapter" data-level="8.2" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#european-datasets-1"><i class="fa fa-check"></i><b>8.2</b> European datasets</a></li>
<li class="chapter" data-level="8.3" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#united-states-datasets"><i class="fa fa-check"></i><b>8.3</b> United States datasets</a><ul>
<li class="chapter" data-level="8.3.1" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#usafacts"><i class="fa fa-check"></i><b>8.3.1</b> USAFacts</a></li>
<li class="chapter" data-level="8.3.2" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#new-york-times-county"><i class="fa fa-check"></i><b>8.3.2</b> New York Times County</a></li>
<li class="chapter" data-level="8.3.3" data-path="epicurve-datasets.html"><a href="epicurve-datasets.html#new-york-times-state"><i class="fa fa-check"></i><b>8.3.3</b> New York Times State</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="map-visualizations.html"><a href="map-visualizations.html"><i class="fa fa-check"></i><b>9</b> Map visualizations</a><ul>
<li class="chapter" data-level="9.1" data-path="map-visualizations.html"><a href="map-visualizations.html#interactive-maps"><i class="fa fa-check"></i><b>9.1</b> Interactive maps</a></li>
<li class="chapter" data-level="9.2" data-path="map-visualizations.html"><a href="map-visualizations.html#united-states"><i class="fa fa-check"></i><b>9.2</b> United States</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Examine the COVID-19 pandemic with data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-replication-rate-r_0" class="section level1">
<h1><span class="header-section-number">6</span> The Replication rate, <span class="math inline">\(R_0\)</span></h1>
<div id="learning-goals-and-objectives" class="section level2">
<h2><span class="header-section-number">6.1</span> Learning goals and objectives</h2>
<ul>
<li>Gain an intuitive understanding of <span class="math inline">\(R_0\)</span>.</li>
<li>Know that the value of <span class="math inline">\(R_0\)</span> determines how quickly a disease spreads or is eliminated.</li>
<li>Name the three main drivers of <span class="math inline">\(R_0\)</span></li>
<li>Learn to estimate <span class="math inline">\(R_0\)</span> from data on the number of infections over time occurring in a population.</li>
</ul>
</div>
<div id="background" class="section level2">
<h2><span class="header-section-number">6.2</span> Background</h2>
<p>The replication rate, <span class="math inline">\(R_0\)</span> is a central value in understanding the rate at which a disease is spreading in a susceptible population.</p>
<div id="what-is-r_0" class="section level3">
<h3><span class="header-section-number">6.2.1</span> What is <span class="math inline">\(R_0\)</span>?</h3>
<p><span class="math inline">\(R_0\)</span> is pronounced “R naught.” The <span class="math inline">\(R_0\)</span> value is an estimate of the average number of people who will be infected by one contagious person. It specifically applies to a population of people who are susceptible to the disease (have not been vaccinated and are not immune). If a disease has an <span class="math inline">\(R_0\)</span> of 18, for example, a contagious person will transmit it to an average of 18 other people, assuming that all people in the community are susceptible.</p>
</div>
<div id="what-do-r_0-values-mean" class="section level3">
<h3><span class="header-section-number">6.2.2</span> What do <span class="math inline">\(R_0\)</span> values mean?</h3>
<p>The <span class="math inline">\(R_0\)</span> value of a disease is important to understanding the dynamics of disease spread. Depending on the <span class="math inline">\(R_0\)</span> value, a disease should follow one of three possible courses in the at-risk community.</p>
<ul>
<li>If <span class="math inline">\(R_0\)</span> is less than 1, each existing infection is spread on average to less than one additional person, leading to decline in the number of cases and eventual end to the spread.</li>
<li>If <span class="math inline">\(R_0\)</span> equals 1, each existing infection causes one new infection, leading to stable infection numbers without increase or decrease with time, on average.</li>
<li>If <span class="math inline">\(R_0\)</span> is more than 1, each existing infection leads to more than one infection, resulting in growth and potential for epidemic/pandemic conditions.</li>
</ul>
<p><em>Importantly, the disease-specific <span class="math inline">\(R_0\)</span> value pplies when each member of the community is fully vulnerable to the disease with</em>:</p>
<ul>
<li>no one vaccinated</li>
<li>no one immune</li>
<li>no way to control the spread of the disease</li>
</ul>
</div>
<div id="what-variables-contribute-to-r_0" class="section level3">
<h3><span class="header-section-number">6.2.3</span> What variables contribute to <span class="math inline">\(R_0\)</span>?</h3>
<p>Three main factors impact the <span class="math inline">\(R_0\)</span> value of a disease:</p>
<ul>
<li><p><em>Infectious period</em>: The time that an infected person can spread the disease varies from one disease to another. Additional factors such as age of the infected person may affect the period during which a person can infect others. A long period of infectiousness will contribute to a higher <span class="math inline">\(R_0\)</span> value.</p></li>
<li><p><em>Contact rate</em>: If a person who’s infected with a contagious disease comes into contact with many people who aren’t infected or vaccinated, the disease will spread more quickly. If that person remains at home, in a hospital, or otherwise quarantined while they’re contagious, the disease will spread more slowly. A high contact rate will contribute to a higher <span class="math inline">\(R_0\)</span> value. The corollary, that lower contact rate, can reduce <span class="math inline">\(R_0\)</span> is the basis for <a href="https://www.nytimes.com/article/flatten-curve-coronavirus.html">flattening the curve</a> through <a href="https://en.wikipedia.org/wiki/Social_distancing">social distancing</a>.</p></li>
<li><p><em>Mode of transmission</em>:
Airborne illnesses tend to have a higher <span class="math inline">\(R_0\)</span> value than those spread through contact or through bodily fluids.</p></li>
</ul>
</div>
</div>
<div id="simulated-epidemic-model" class="section level2">
<h2><span class="header-section-number">6.3</span> Simulated epidemic model</h2>
<p><strong>TODO</strong>: plot of incidence along with <span class="math inline">\(R_0(t)\)</span></p>
<p>Following code conveyed by John Mallery, we have the following
approach for estimating <span class="math inline">\(R_0\)</span> using a single realization of
an epidemic simulation.</p>
<p>Note that there can be failures of <code>estimate.R</code> for certain
inputs. We are working on that.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">library</span>(sars2pack)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">library</span>(R0)</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="co"># Generating an epidemic with given parameters</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">5432</span>)  <span class="co"># always initialize when simulating!</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7">mEpid &lt;-<span class="st"> </span><span class="kw">sim.epid</span>(<span class="dt">epid.nb=</span><span class="dv">1</span>, <span class="dt">GT=</span>mGT, <span class="dt">epid.length=</span><span class="dv">30</span>, </a>
<a class="sourceLine" id="cb48-8" data-line-number="8">     <span class="dt">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="dt">R0=</span><span class="fl">1.67</span>, <span class="dt">peak.value=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb48-9" data-line-number="9">mEpid &lt;-<span class="st"> </span>mEpid[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb48-10" data-line-number="10"><span class="co"># Running estimations</span></a>
<a class="sourceLine" id="cb48-11" data-line-number="11">est &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>mEpid, <span class="dt">GT=</span>mGT, <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>,<span class="st">&quot;ML&quot;</span>,<span class="st">&quot;TD&quot;</span>), <span class="dt">begin=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">30</span>)</a></code></pre></div>
<p>We modified the plotting function in <em><a href="https://CRAN.R-project.org/package=R0">R0</a></em> which
was calling <code>dev.new</code> too often. Use <code>plot2</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">sars2pack<span class="op">::</span><span class="kw">plot2</span>(est)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/lksim-1.png" width="672" /></p>
<p>The <code>plotfit2</code> function is also useful. These fits
look identical but they are not.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">sars2pack<span class="op">::</span><span class="kw">plotfit2</span>(est)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/lksim2-1.png" width="672" /></p>
</div>
<div id="real-data-examples" class="section level2">
<h2><span class="header-section-number">6.4</span> Real data examples</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<p>Now we extract information from the time-series table and
obtain estimates of <span class="math inline">\(R_0\)</span> under exponential growth.</p>
<div id="hubei-province" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Hubei Province</h3>
<p>We are able to use exponential growth and time-dependent models
with this data, using generation time model from a
recent <a href="https://annals.org/aim/fullarticle/2762808/incubation-period-coronavirus-disease-2019-covid-19-from-publicly-reported">Annals of Internal Medicine</a> paper.</p>
<p>The incidence data probably need smoothing, and the time-dependent
model has unreasonable fluctuations.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">dates =<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">as_date</span>(<span class="kw">mdy</span>(<span class="kw">names</span>(mar19df)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)]))</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">hubdat =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">get_series</span>(<span class="dt">province=</span><span class="st">&quot;Hubei&quot;</span>, <span class="dt">country=</span><span class="st">&quot;China&quot;</span>, </a>
<a class="sourceLine" id="cb52-3" data-line-number="3">    <span class="dt">dataset=</span>sars2pack<span class="op">::</span>mar19df))</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="kw">names</span>(hubdat) =<span class="st"> </span>dates</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="fl">5.8</span>, <span class="fl">0.95</span>)) <span class="co"># from DOI 10.7326/M20-0504</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="fl">3.96</span>, <span class="fl">4.75</span>)) <span class="co"># from DOI 10.7326/M20-0504</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">hubdat.filt =<span class="st"> </span><span class="kw">trim_leading_values</span>(<span class="kw">c</span>(hubdat[<span class="dv">1</span>], <span class="kw">diff</span>(hubdat)))</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">est.EG &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>hubdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb52-9" data-line-number="9">    <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>, <span class="st">&quot;TD&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(hubdat.filt)))</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">est.EG</a></code></pre></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  0.8190473[ 0.8164334 , 0.821658 ]
## 
## Reproduction number estimate using  Time-Dependent  method.
## 2.020789 0 3.0142 3.134995 3.32356 3.865543 1.596743 0 1.878637 2.079345 ...</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">plot2</span>(est.EG)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">plotfit2</span>(est.EG)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/dohub-1.png" width="672" /></p>
</div>
<div id="italy" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Italy</h3>
<p>For Italy, only the EG model seems to work, with the
Annals of Internal Medicine generation time model. It
fits the data reasonably well, but the data seems to include
a reporting gap.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">itdat =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">get_series</span>(<span class="dt">province=</span><span class="st">&quot;&quot;</span>, <span class="dt">country=</span><span class="st">&quot;Italy&quot;</span>, </a>
<a class="sourceLine" id="cb55-2" data-line-number="2">    <span class="dt">dataset=</span>sars2pack<span class="op">::</span>mar19df))</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">names</span>(itdat) =<span class="st"> </span>dates</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">itdat.filt =<span class="st"> </span><span class="kw">trim_leading_values</span>(<span class="kw">c</span>(itdat[<span class="dv">1</span>], <span class="kw">diff</span>(itdat)))</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">est.EG &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>itdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb55-6" data-line-number="6">    <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(itdat.filt)))</a>
<a class="sourceLine" id="cb55-7" data-line-number="7">est.EG</a></code></pre></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  1.968466[ 1.957161 , 1.979874 ]</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">plot2</span>(est.EG, <span class="dt">main=</span><span class="st">&quot;Italy&quot;</span>)</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="kw">plotfit2</span>(est.EG, <span class="dt">main=</span><span class="st">&quot;Italy&quot;</span>)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/doit-1.png" width="672" /></p>
</div>
<div id="new-york-city" class="section level3">
<h3><span class="header-section-number">6.4.3</span> New York City</h3>
<p><strong>TODO</strong>: plot of incidence along with <span class="math inline">\(R_0(t)\)</span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">nyt =<span class="st"> </span><span class="kw">nytimes_county_data</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(county<span class="op">==</span><span class="st">&#39;New York City&#39;</span> <span class="op">&amp;</span><span class="st"> </span>subset<span class="op">==</span><span class="st">&#39;confirmed&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(date)</a>
<a class="sourceLine" id="cb58-4" data-line-number="4">nytdat =<span class="st"> </span>nyt<span class="op">$</span>count</a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="co"># do we need to chop zeros off? Seems like not.</span></a>
<a class="sourceLine" id="cb58-6" data-line-number="6">nytdat.filt =<span class="st"> </span><span class="kw">c</span>(nytdat[<span class="dv">1</span>], <span class="kw">diff</span>(nytdat))</a>
<a class="sourceLine" id="cb58-7" data-line-number="7">est &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>nytdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb58-8" data-line-number="8">                  <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>,<span class="st">&quot;TD&quot;</span>,<span class="st">&quot;ML&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(nytdat.filt)))</a></code></pre></div>
<p>We can also use the package <em><a href="https://CRAN.R-project.org/package=EpiEstim">EpiEstim</a></em> to perform time-dependent <span class="math inline">\(R_0\)</span> calculations.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">library</span>(EpiEstim)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">epiestim =<span class="st"> </span>EpiEstim<span class="op">::</span><span class="kw">estimate_R</span>(nytdat.filt, <span class="dt">method =</span> <span class="st">&quot;parametric_si&quot;</span>,</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">                                <span class="dt">config =</span> EpiEstim<span class="op">::</span><span class="kw">make_config</span>(<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb59-4" data-line-number="4">                                    <span class="dt">mean_si =</span> <span class="fl">3.96</span>, <span class="dt">std_si =</span> <span class="fl">4.75</span>)))</a>
<a class="sourceLine" id="cb59-5" data-line-number="5"><span class="kw">invisible</span>(<span class="kw">plot</span>(epiestim))</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="use-cases.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="european-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seandavi/COVID19Book/edit/master/r0_estimates.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/seandavi/COVID19Book/commits/master/r0_estimates.Rmd",
"text": null
},
"view": {
"link": "https://github.com/seandavi/COVID19Book/blob/master/r0_estimates.Rmd",
"text": null
},
"download": ["covid_19.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
